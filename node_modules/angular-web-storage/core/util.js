var StorageUtil = (function () {
    function StorageUtil() {
    }
    StorageUtil.get = function (storage, key) {
        var value = StorageUtil.parse(storage.getItem(key) || 'null') || null;
        if (value === null)
            return null;
        if (typeof value === 'object'
            && typeof value._expired !== 'undefined'
            && value._expired !== 0
            && +new Date > value._expired) {
            StorageUtil.remove(storage, key);
            return null;
        }
        return value._value || null;
    };
    StorageUtil.set = function (storage, key, value, expiredAt, expiredUnit) {
        if (expiredAt === void 0) { expiredAt = 0; }
        if (expiredUnit === void 0) { expiredUnit = 't'; }
        storage.setItem(key, StorageUtil.stringify({
            _expired: StorageUtil.getExpired(expiredAt, expiredUnit),
            _value: value
        }));
    };
    StorageUtil.remove = function (storage, key) {
        storage.removeItem(key);
    };
    StorageUtil.getExpired = function (val, unit) {
        if (val <= 0)
            return 0;
        var now = +new Date();
        switch (unit) {
            case 's':
                return now + (1000 * val);
            case 'm':
                return now + (1000 * 60 * val);
            case 'h':
                return now + (1000 * 60 * 60 * val);
            case 'd':
                return now + (1000 * 60 * 60 * 24 * val);
            case 'w':
                return now + (1000 * 60 * 60 * 24 * 7 * val);
            case 'y':
                return now + (1000 * 60 * 60 * 24 * 365 * val);
            case 't':
                return now + val;
        }
        return 0;
    };
    StorageUtil.stringify = function (value) {
        return JSON.stringify(value);
    };
    StorageUtil.parse = function (text) {
        try {
            return JSON.parse(text) || null;
        }
        catch (e) {
            return text;
        }
    };
    return StorageUtil;
}());
export { StorageUtil };
//# sourceMappingURL=util.js.map