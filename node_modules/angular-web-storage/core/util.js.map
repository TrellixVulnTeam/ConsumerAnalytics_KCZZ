{"version":3,"sources":["../../src/core/util.ts"],"names":[],"mappings":"AAYA;IAAA;IA2DA,CAAC;IA1DU,eAAG,GAAV,UAAW,OAAgB,EAAE,GAAW;QACpC,IAAM,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,MAAM,CAAC,IAAI,IAAI,CAAC;QACxE,EAAE,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC;YAAC,MAAM,CAAC,IAAI,CAAC;QAChC,EAAE,CAAC,CAAC,OAAO,KAAK,KAAK,QAAQ;eACtB,OAAO,KAAK,CAAC,QAAQ,KAAK,WAAW;eACrC,KAAK,CAAC,QAAQ,KAAK,CAAC;eACpB,CAAC,IAAI,IAAI,GAAG,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;YAChC,WAAW,CAAC,MAAM,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;YACjC,MAAM,CAAC,IAAI,CAAC;QAChB,CAAC;QAED,MAAM,CAAC,KAAK,CAAC,MAAM,IAAI,IAAI,CAAC;IAChC,CAAC;IAEM,eAAG,GAAV,UAAW,OAAgB,EAAE,GAAW,EAAE,KAAU,EAAE,SAAqB,EAAE,WAA8B;QAArD,0BAAA,EAAA,aAAqB;QAAE,4BAAA,EAAA,iBAA8B;QACvG,OAAO,CAAC,OAAO,CAAC,GAAG,EAAE,WAAW,CAAC,SAAS,CAAC;YACvC,QAAQ,EAAE,WAAW,CAAC,UAAU,CAAC,SAAS,EAAE,WAAW,CAAC;YACxD,MAAM,EAAE,KAAK;SAChB,CAAC,CAAC,CAAC;IACR,CAAC;IAEM,kBAAM,GAAb,UAAc,OAAgB,EAAE,GAAW;QACvC,OAAO,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;IAC5B,CAAC;IAEc,sBAAU,GAAzB,UAA0B,GAAW,EAAE,IAAiB;QACpD,EAAE,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC;YAAC,MAAM,CAAC,CAAC,CAAC;QACvB,IAAM,GAAG,GAAG,CAAC,IAAI,IAAI,EAAE,CAAC;QACxB,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;YACX,KAAK,GAAG;gBACJ,MAAM,CAAC,GAAG,GAAG,CAAC,IAAI,GAAG,GAAG,CAAC,CAAC;YAC9B,KAAK,GAAG;gBACJ,MAAM,CAAC,GAAG,GAAG,CAAC,IAAI,GAAG,EAAE,GAAG,GAAG,CAAC,CAAC;YACnC,KAAK,GAAG;gBACJ,MAAM,CAAC,GAAG,GAAG,CAAC,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG,CAAC,CAAC;YACxC,KAAK,GAAG;gBACJ,MAAM,CAAC,GAAG,GAAG,CAAC,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG,CAAC,CAAC;YAC7C,KAAK,GAAG;gBACJ,MAAM,CAAC,GAAG,GAAG,CAAC,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC;YACjD,KAAK,GAAG;gBACJ,MAAM,CAAC,GAAG,GAAG,CAAC,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;YACnD,KAAK,GAAG;gBACJ,MAAM,CAAC,GAAG,GAAG,GAAG,CAAC;QACzB,CAAC;QACD,MAAM,CAAC,CAAC,CAAC;IACb,CAAC;IAEc,qBAAS,GAAxB,UAAyB,KAAU;QAC/B,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;IACjC,CAAC;IAEc,iBAAK,GAApB,UAAqB,IAAY;QAC7B,IAAI,CAAC;YACD,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC;QACpC,CAAC;QAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACT,MAAM,CAAC,IAAI,CAAC;QAChB,CAAC;IACL,CAAC;IACL,kBAAC;AAAD,CA3DA,AA2DC,IAAA","file":"util.js","sourceRoot":"","sourcesContent":["/**\r\n * 过期时间单位\r\n * s：秒\r\n * m：分\r\n * h：时\r\n * d：天\r\n * w：周\r\n * y：年\r\n * t：自定义（毫秒ms）\r\n */\r\nexport type ExpiredUnit = 's' | 'm' | 'h' | 'd' | 'w' | 'y' | 't';\r\n\r\nexport class StorageUtil {\r\n    static get(storage: Storage, key: string) {\r\n        const value = StorageUtil.parse(storage.getItem(key) || 'null') || null;\r\n        if (value === null) return null;\r\n        if (typeof value === 'object'\r\n            && typeof value._expired !== 'undefined'\r\n            && value._expired !== 0\r\n            && +new Date > value._expired) {\r\n            StorageUtil.remove(storage, key);\r\n            return null;\r\n        }\r\n\r\n        return value._value || null;\r\n    }\r\n\r\n    static set(storage: Storage, key: string, value: any, expiredAt: number = 0, expiredUnit: ExpiredUnit = 't') {\r\n        storage.setItem(key, StorageUtil.stringify({\r\n            _expired: StorageUtil.getExpired(expiredAt, expiredUnit),\r\n            _value: value\r\n        }));\r\n    }\r\n\r\n    static remove(storage: Storage, key: string) {\r\n        storage.removeItem(key);\r\n    }\r\n\r\n    private static getExpired(val: number, unit: ExpiredUnit): number {\r\n        if (val <= 0) return 0;\r\n        const now = +new Date();\r\n        switch (unit) {\r\n            case 's':   // 秒\r\n                return now + (1000 * val);\r\n            case 'm':   // 分\r\n                return now + (1000 * 60 * val);\r\n            case 'h':   // 时\r\n                return now + (1000 * 60 * 60 * val);\r\n            case 'd':   // 天\r\n                return now + (1000 * 60 * 60 * 24 * val);\r\n            case 'w':   // 周\r\n                return now + (1000 * 60 * 60 * 24 * 7 * val);\r\n            case 'y':   // 年\r\n                return now + (1000 * 60 * 60 * 24 * 365 * val);\r\n            case 't':   // 自定义\r\n                return now + val;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    private static stringify(value: any) {\r\n        return JSON.stringify(value);\r\n    }\r\n\r\n    private static parse(text: string) {\r\n        try {\r\n            return JSON.parse(text) || null;\r\n        } catch (e) {\r\n            return text;\r\n        }\r\n    }\r\n}\r\n"]}