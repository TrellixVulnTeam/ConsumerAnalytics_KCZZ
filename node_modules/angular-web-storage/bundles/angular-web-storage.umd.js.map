{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap f13478d81f3b831005b6","webpack:///./src/core/service.ts","webpack:///./src/core/util.ts","webpack:///external \"@angular/core\"","webpack:///./src/core/decorator.ts","webpack:///./src/core/module.ts","webpack:///./src/index.ts"],"names":[],"mappings":"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","file":"angular-web-storage.umd.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@angular/core\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"@angular/core\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"angular-web-storage.umd\"] = factory(require(\"@angular/core\"));\n\telse\n\t\troot[\"angular-web-storage.umd\"] = factory(root[\"@angular/core\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f13478d81f3b831005b6","import { Injectable } from '@angular/core';\r\nimport { StorageUtil, ExpiredUnit } from './util';\r\n\r\nexport class StorageService {\r\n    constructor(private storage: Storage) { }\r\n    \r\n    get(key: string) {\r\n        return StorageUtil.get(this.storage, key);\r\n    }\r\n\r\n    set(key: string, value: any, expiredAt: number = 0, expiredUnit: ExpiredUnit = 'd') {\r\n        return StorageUtil.set(this.storage, key, value, expiredAt, expiredUnit);\r\n    }\r\n\r\n    remove(key: string) {\r\n        StorageUtil.remove(this.storage, key);\r\n    }\r\n\r\n    clear() {\r\n        this.storage.clear();\r\n    }\r\n}\r\n\r\n@Injectable()\r\nexport class LocalStorageService extends StorageService {\r\n    constructor() {\r\n        super(localStorage);\r\n    }\r\n}\r\n\r\n@Injectable()\r\nexport class SessionStorageService extends StorageService {\r\n    constructor() {\r\n        super(sessionStorage);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/service.ts","/**\r\n * 过期时间单位\r\n * s：秒\r\n * m：分\r\n * h：时\r\n * d：天\r\n * w：周\r\n * y：年\r\n * t：自定义（毫秒ms）\r\n */\r\nexport type ExpiredUnit = 's' | 'm' | 'h' | 'd' | 'w' | 'y' | 't';\r\n\r\nexport class StorageUtil {\r\n    static get(storage: Storage, key: string) {\r\n        const value = StorageUtil.parse(storage.getItem(key) || 'null') || null;\r\n        if (value === null) return null;\r\n        if (typeof value === 'object'\r\n            && typeof value._expired !== 'undefined'\r\n            && value._expired !== 0\r\n            && +new Date > value._expired) {\r\n            StorageUtil.remove(storage, key);\r\n            return null;\r\n        }\r\n\r\n        return value._value || null;\r\n    }\r\n\r\n    static set(storage: Storage, key: string, value: any, expiredAt: number = 0, expiredUnit: ExpiredUnit = 't') {\r\n        storage.setItem(key, StorageUtil.stringify({\r\n            _expired: StorageUtil.getExpired(expiredAt, expiredUnit),\r\n            _value: value\r\n        }));\r\n    }\r\n\r\n    static remove(storage: Storage, key: string) {\r\n        storage.removeItem(key);\r\n    }\r\n\r\n    private static getExpired(val: number, unit: ExpiredUnit): number {\r\n        if (val <= 0) return 0;\r\n        const now = +new Date();\r\n        switch (unit) {\r\n            case 's':   // 秒\r\n                return now + (1000 * val);\r\n            case 'm':   // 分\r\n                return now + (1000 * 60 * val);\r\n            case 'h':   // 时\r\n                return now + (1000 * 60 * 60 * val);\r\n            case 'd':   // 天\r\n                return now + (1000 * 60 * 60 * 24 * val);\r\n            case 'w':   // 周\r\n                return now + (1000 * 60 * 60 * 24 * 7 * val);\r\n            case 'y':   // 年\r\n                return now + (1000 * 60 * 60 * 24 * 365 * val);\r\n            case 't':   // 自定义\r\n                return now + val;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    private static stringify(value: any) {\r\n        return JSON.stringify(value);\r\n    }\r\n\r\n    private static parse(text: string) {\r\n        try {\r\n            return JSON.parse(text) || null;\r\n        } catch (e) {\r\n            return text;\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/util.ts","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@angular/core\"\n// module id = 2\n// module chunks = 0","import { ExpiredUnit, StorageUtil } from \"./util\";\r\n\r\n/**\r\n * localStorage 装饰器\r\n * \r\n * @export\r\n * @param {string} [key] 指定一个新key\r\n * @param {number} [expiredAt=0] 过期时间值，0表示永久有效。\r\n * @param {ExpiredUnit} [expiredUnit='t'] 过期时间单位（默认：自定义[单位：毫秒]）\r\n * @returns \r\n */\r\nexport function LocalStorage(key?: string, expiredAt: number = 0, expiredUnit: ExpiredUnit = 't') {\r\n    return WebStorage(localStorage, key, expiredAt, expiredUnit);\r\n}\r\n\r\n/**\r\n * sessionStorage 装饰器\r\n * \r\n * @export\r\n * @param {string} [key] 指定一个新key\r\n * @returns \r\n */\r\nexport function SessionStorage(key?: string) {\r\n    return WebStorage(sessionStorage, key);\r\n}\r\n\r\ninterface ICache {\r\n    [key: string]: boolean;\r\n}\r\n\r\nlet cache: ICache = {};\r\nconst WebStorage = (storage: Storage, key: string, expiredAt: number = 0, expiredUnit: ExpiredUnit = 'd') => {\r\n    return (target: Object, propertyName: string): void => {\r\n        key = key || propertyName;\r\n        Object.defineProperty(target, propertyName, {\r\n            get: () => {\r\n                return StorageUtil.get(storage, <string>key);\r\n            },\r\n            set: (value: any) => {\r\n                if (!cache[<string>key]) {\r\n                    const storedValue = StorageUtil.get(storage, <string>key);\r\n                    if (storedValue === null) {\r\n                        StorageUtil.set(storage, <string>key, value, expiredAt, expiredUnit);\r\n                    }\r\n                    cache[<string>key] = true;\r\n                    return;\r\n                }\r\n                StorageUtil.set(storage, <string>key, value, expiredAt, expiredUnit);\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        })\r\n    };\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/decorator.ts","import { NgModule } from \"@angular/core\";\r\nimport { LocalStorageService, SessionStorageService } from './service';\r\n\r\n@NgModule({\r\n    providers: [LocalStorageService, SessionStorageService]\r\n})\r\nexport class AngularWebStorageModule { }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/module.ts","export { ExpiredUnit } from './core/util';\nexport { LocalStorage, SessionStorage } from './core/decorator';\nexport { LocalStorageService, SessionStorageService } from './core/service';\nexport { AngularWebStorageModule } from './core/module';\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts"],"sourceRoot":""}